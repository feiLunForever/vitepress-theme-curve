# JVM架构篇

## JVM、JDK、JRE

- Java 虚拟机（JVM）是运行 Java 字节码的虚拟机

    - JVM 有针对不同系统的特定实现，目的是使用相同的字节码，它们都会给出相同的结果。
    - 字节码和不同系统的 JVM 实现是 Java 语言“一次编译，随处可以运行”的关键所在。
- JRE 是 Java 运行时环境。

    - 它是运行已编译 Java 程序所需的所有内容的集合，包括 Java 虚拟机（JVM），Java 类库，java 命令和其他的一些基础构件。
    - 但是，它不能用于创建新程序
- JDK 是功能齐全的 Java SDK。

    - 它拥有 JRE 所拥有的一切，还有编译器（javac）和工具（如 javadoc 和 jdb）。
    - 它能够创建和编译程序。

## JVM 组成架构

Java虚拟机一般是由多个模块一起组成的，主要可分为类加载子系统、执行引擎子系统、运行时数据区、垃圾回收子系统以及本地接口和本地方法库。

在Java程序启动/执行过程中，这些模块各司其职，相互配合，组成了整个Java的执行平台 - JVM。

### 类加载子系统

> 加载编译后 class 文件

类加载子系统是用于加载编译后`class`文件的，但它只负责将符合格式要求的`class`字节码信息加载进内存，而只要符合格式规范的`class`文件都能被加载，至于加载进入的`class`文件到底是否能执行就并不是它负责的了，这是执行引擎子系统的范围之内的责任。

> 而类加载子系统中，核心知识点分为 `类加载器`、`双亲委派模型`、`类加载`过程三大块。

### 执行引擎子系统

- 将加载进内存的 class 字节码指令“翻译”成机器语言交由硬件执行

### 运行时数据区

> 开发者编写的所有代码最终都会被加载在这里之后再开始执行。同时，Java 为何能够避免像 C 那样，需要手动管理内存的原因之一也在于这块区域。

- PC 程序计数器
- 本地方法栈
- 虚拟机栈
- 元数据空间(方法区)
- 堆

<img src="https://gitee.com/JBL_lun/tuchuang/raw/master/assets/image-20250613231451198.png" alt="image-20250613231451198" style="zoom:60%;" />

### 垃圾回收子系统

GC模块的主要任务就是帮助Java程序管理内存，对于垃圾对象的清除、存活对象的管理以及内存碎片的回收等工作，都交由GC系统负责。

> > JVM的GC机制里面重点知识点分为三块：`垃圾回收器`、`垃圾回收算法`、`GC调优`。

### 本地接口和本地方法库

> native 方法

本地方法接口的作用主要是为了融合不同的编程语言为Java所用，它的初衷是融合C/C++程序。

简而言之，本地方法接口就是一个Java调用非Java代码的接口，这个非Java代码一般泛指C语言所编写的本地方法库中的函数。